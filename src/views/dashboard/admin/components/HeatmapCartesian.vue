<template>
  <div :class="className" :style="{height:height,width:width}" />
</template>

<script>
import echarts from 'echarts'
require('echarts/theme/macarons') // echarts theme
import resize from './mixins/resize'

// const animationDuration = 6000

export default {
  mixins: [resize],
  props: {
    className: {
      type: String,
      default: 'chart'
    },
    width: {
      type: String,
      default: '100%'
    },
    height: {
      type: String,
      default: '300px'
    }
  },
  data() {
    return {
      chart: null
    }
  },
  mounted() {
    this.$nextTick(() => {
      this.initChart()
    })
  },
  beforeDestroy() {
    if (!this.chart) {
      return
    }
    this.chart.dispose()
    this.chart = null
  },
  methods: {
    initChart() {
      this.chart = echarts.init(this.$el, 'macarons')

      var hours = ['1', '2', '3', '4', '5', '6',
        '7', '8', '9', '10', '11',
        '12', '13', '14', '15', '16', '17',
        '18', '19', '20', '21', '22', '23', '24']
      var days = ['周一', '周二', '周三',
        '周四', '周五', '周六', '周日']

      var data = [[0, 0, 18.5], [0, 1, 18.6], [0, 2, 19.5], [0, 3, 17.5], [0, 4, 18.3], [0, 5, 18.5], [0, 6, 18.4], [0, 7, 19.5], [0, 8, 23.5], [0, 9, 21.5], [0, 10, 26.4],
        [0, 11, 24.5], [0, 12, 24.5], [0, 13, 25.8], [0, 14, 24.9], [0, 15, 25.8], [0, 16, 27.5], [0, 17, 25.8], [0, 18, 19.5], [0, 19, 19.8], [0, 20, 18.8], [0, 21, 24.3],
        [0, 22, 25.8], [0, 23, 18.4],
        [1, 0, 15.5], [1, 1, 20.5], [1, 2, 19.7], [1, 3, 18.5], [1, 4, 16.5], [1, 5, 18.5], [1, 6, 21.8], [1, 7, 20.6], [1, 8, 20.4], [1, 9, 21.5], [1, 10, 22.8],
        [1, 11, 23.5], [1, 12, 26.8], [1, 13, 27.8], [1, 14, 26.6], [1, 15, 25.7], [1, 16, 26.5], [1, 17, 24.7], [1, 18, 19.8], [1, 19, 20.5], [1, 20, 20.1],
        [1, 21, 18.8], [1, 22, 17.2], [1, 23, 16.5],
        [2, 0, 16.5], [2, 1, 16.2], [2, 2, 17.8], [2, 3, 17.5], [2, 4, 17.8], [2, 5, 18.5], [2, 6, 18.5], [2, 7, 19.6], [2, 8, 18.8], [2, 9, 20.4], [2, 10, 21.6],
        [2, 11, 23.2], [2, 12, 23.5], [2, 13, 24.5], [2, 14, 25.5], [2, 15, 29.5], [2, 16, 28.3], [2, 17, 20.4], [2, 18, 24.5], [2, 19, 20.4], [2, 20, 21.3],
        [2, 21, 18.8], [2, 22, 19.2], [2, 23, 17.4],
        [3, 0, 17.2], [3, 1, 16.5], [3, 2, 17.7], [3, 3, 16.6], [3, 4, 18.5], [3, 5, 17.6], [3, 6, 18.8], [3, 7, 20.3], [3, 8, 20.8], [3, 9, 21.5], [3, 10, 20.6],
        [3, 11, 24.1], [3, 12, 21.5], [3, 13, 24.2], [3, 14, 23.5], [3, 15, 22.5], [3, 16, 23.1], [3, 17, 25.4], [3, 18, 25.2], [3, 19, 18.8], [3, 20, 19.2],
        [3, 21, 16.6], [3, 22, 17.7], [3, 23, 17.5],
        [4, 0, 18.8], [4, 1, 16.5], [4, 2, 17.4], [4, 3, 18.8], [4, 4, 15.6], [4, 5, 18.8], [4, 6, 17.4], [4, 7, 19.2], [4, 8, 20.1], [4, 9, 20.3], [4, 10, 21.2],
        [4, 11, 22.5], [4, 12, 22.5], [4, 13, 21.6], [4, 14, 23.5], [4, 15, 22.3], [4, 16, 19.9], [4, 17, 18.8], [4, 18, 18.8], [4, 19, 20.8], [4, 20, 18.8],
        [4, 21, 19.8], [4, 22, 17.2], [4, 23, 16.8],
        [5, 0, 18.8], [5, 1, 16.6], [5, 2, 18.8], [5, 3, 17.5], [5, 4, 18.7], [5, 5, 16.5], [5, 6, 17.6], [5, 7, 19.2], [5, 8, 18.8], [5, 9, 19.2], [5, 10, 20.3],
        [5, 11, 21.3], [5, 12, 22.6], [5, 13, 20.5], [5, 14, 25.5], [5, 15, 24.3], [5, 16, 30.3], [5, 17, 26.1], [5, 18, 20.8], [5, 19, 19.3], [5, 20, 23.5],
        [5, 21, 18.5], [5, 22, 17.8], [5, 23, 17.3],
        [6, 0, 17.8], [6, 1, 16.5], [6, 2, 18.8], [6, 3, 17.3], [6, 4, 15.3], [6, 5, 16.6], [6, 6, 15.6], [6, 7, 19.5], [6, 8, 20.4], [6, 9, 21.5], [6, 10, 22.3],
        [6, 11, 25.6], [6, 12, 24.3], [6, 13, 23.5], [6, 14, 28.3], [6, 15, 21.5], [6, 16, 26.8], [6, 17, 20.5], [6, 18, 21.6], [6, 19, 18.8], [6, 20, 17.4],
        [6, 21, 20.5], [6, 22, 20.2], [6, 23, 16.9]]

      data = data.map(function(item) {
        return [item[1], item[0], item[2] || '-']
      })

      this.chart.setOption({
        title: {
          text: '每周室内温度分布图',
          left: 'center'
        },
        tooltip: {
          position: 'top'
        },
        animation: false,
        grid: {
          height: '50%',
          top: '10%'
        },
        xAxis: {
          type: 'category',
          data: hours,
          splitArea: {
            show: true
          }
        },
        yAxis: {
          type: 'category',
          data: days,
          splitArea: {
            show: true
          }
        },
        visualMap: {
          inRange: {
            color: ['#f2e3a0', '#d57a6e', '#bf464e']
            // symbolSize: [30, 100]
          },
          min: 15,
          max: 30,
          calculable: true,
          orient: 'horizontal',
          left: 'center',
          bottom: '15%',
          textStyle: {
            color: '#1e98d3'
          }
        },
        series: [{
          name: '温度',
          type: 'heatmap',
          data: data,
          label: {
            show: true
          },
          emphasis: {
            itemStyle: {
              shadowBlur: 10,
              shadowColor: 'rgba(0, 0, 0, 0.5)'
            }
          }
        }]
      })
    }
  }
}
</script>
